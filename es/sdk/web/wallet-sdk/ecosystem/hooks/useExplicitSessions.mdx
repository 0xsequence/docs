---
title: useExplicitSessions
description: Hook para gestionar sesiones explícitas en conexiones de wallet Sequence V3
sidebarTitle: useExplicitSessions
---

## Importar

```tsx
import { useExplicitSessions } from '@0xsequence/connect'
```

## Uso

```tsx
import { createContractPermission, createExplicitSession, useExplicitSessions, type Permission, type Session } from '@0xsequence/connect'
import { useEffect, useState } from 'react'
import { parseUnits } from 'viem'

function App() {
  const {
    isLoading,
    error,
    addExplicitSession,
    getExplicitSessions
  } = useExplicitSessions()

  const [sessions, setSessions] = useState<Session[]>([])

  // Load existing sessions
  useEffect(() => {
    const loadSessions = async () => {
      try {
        const existingSessions = await getExplicitSessions()
        setSessions(existingSessions)
      } catch (err) {
        console.error('Failed to load sessions:', err)
      }
    }

    loadSessions()
  }, [getExplicitSessions])

  // Function to handle modifying an existing explicit session
  const handleModifySession = () => {
    const newPermission = createContractPermission({
      address: '0x...',
      functionSignature: 'function testContract() public'
    })
    const currentSession = sessions[0];
    const modifiedSession = { ...currentSession, permissions: [...currentSession.permissions!, newPermission] }
    modifyExplicitSession(modifiedSession)
  }

  // Handle creating a new explicit session
  const handleCreateSession = async () => {
    try {
      const tokenSpendingSession = createExplicitSession({
        chainId: 42161,
        nativeTokenSpending: {
          valueLimit: 0n,
        },
        expiresIn: {
          days: 3
        },
        permissions: [
          createContractPermission({
            address: '0x...',
            functionSignature: 'function transfer(address to, uint256 amount)',
              rules: [
                {
                  param: 'amount',
                  type: 'uint256',
                  condition: 'LESS_THAN_OR_EQUAL',
                  value: parseUnits('100', 6), // Max cumulative amount of 100 USDC
                  cumulative: true
                }
              ]
          })
        ]
      })

      await addExplicitSession(42161, tokenSpendingSession)

      // Refresh sessions after creating a new one
      const updatedSessions = await getExplicitSessions()
      setSessions(updatedSessions)
    } catch (err) {
      console.error('Failed to create session:', err)
    }
  }

  if (isLoading) {
    return <div>Creating session...</div>
  }

  if (error) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h2>Explicit Sessions</h2>
      <button onClick={handleCreateSession}>
        Create New Session
      </button>

      <button onClick={handleModifySession}>
        Modify Session
      </button>

      <div>
        <h3>Existing Sessions ({sessions.length})</h3>
        {sessions.map((session, index) => (
          <div key={index}>
            <p>Session Address: {session.address}</p>
            <p>Chain ID: {session.chainId}</p>
            <p>Is Implicit: {session.isImplicit ? 'Yes' : 'No'}</p>
            <p>Permissions: {session.permissions?.permissions?.map((permission: Permission) => permission.target).join(', ')}</p>
          </div>
        ))}
      </div>
    </div>
  )
}
```

## Tipo de retorno
El hook retorna un objeto con las siguientes propiedades:

```tsx
type UseExplicitSessionsReturnType = {
  isLoading: boolean
  error: Error | null
  addExplicitSession: (chainId: ChainId, explicitSession: ExplicitSession) => Promise<void>
  getExplicitSessions: () => Promise<Session[]>
}
```

### Propiedades

#### isLoading
`boolean`

Un booleano que indica si la operación de solicitud de sesión está en curso.

#### error
`Error | null`

Un objeto de error si la última operación falló, de lo contrario `null`.

#### addExplicitSession
`(chainId: ChainId, explicitSession: ExplicitSession) => Promise<void>`

```typescript
type ExplicitSession = {
  sessionAddress: Address.Address
  valueLimit: bigint
  deadline: bigint
  permissions: Permission.Permission[]
  chainId: number
  type: 'explicit'
}
```

Función para crear una nueva sesión explícita.

#### modificarExplicitSession
`(explicitSession: ExplicitSession) => Promise<void>`

```typescript
type ExplicitSession = {
  sessionAddress: Address.Address
  valueLimit: bigint
  deadline: bigint
  permissions: Permission.Permission[]
  chainId: number
  type: 'explicit'
}
```

Función para modificar una sesión explícita existente.

#### getExplicitSessions
`() => Promise<Session[]>`

```typescript
type Session = {
  type: 'explicit' | 'implicit'
  sessionAddress: Address.Address
  valueLimit?: bigint
  deadline?: bigint
  permissions?: Permission.Permission[]
  chainId?: number
}
```

Función para obtener todas las sesiones de la wallet conectada.

## Notas
Este hook proporciona funcionalidad para gestionar sesiones explícitas en conexiones de wallet Sequence V3.

Características principales:
- Cree nuevas sesiones explícitas con permisos y límites de gasto personalizados
- Obtenga todas las sesiones explícitas existentes para la wallet conectada
- Modificar sesiones explícitas existentes
- Manejo de errores integrado para problemas comunes de conexión
- Estados de carga para una mejor experiencia de usuario
- Filtrado automático de sesiones para mostrar solo sesiones explícitas