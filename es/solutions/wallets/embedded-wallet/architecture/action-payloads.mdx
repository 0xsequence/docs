---
title: Cargas de acción
description: La Cartera Integrada de Sequence utiliza cargas de acción en formato
  JSON para operaciones de escritura.
sidebarTitle: Cargas de Acción
---

Cada operación de escritura en la Cartera Integrada de Sequence utiliza una carga. Las cargas son objetos JSON. Contienen todos los datos sobre la intención de la acción y la firma del usuario.

El SDK de la Cartera Integrada genera las Cargas. Para completar la acción, envíalas a la API de la Cartera Integrada.

La clave de la API de la Cartera Integrada autentica todas las llamadas a la API de la Cartera Integrada. Esto incluye llamadas al`/sendPayload` endpoint. La clave de la API de la Cartera Integrada es un secreto. Mantenla segura y nunca la compartas ni la almacenes en una aplicación del lado del cliente.

## Estructura de la carga

No necesitas modificar manualmente el contenido de la carga para integrar la Cartera Integrada. Pero tienen definiciones estrictas. Úsalas si las necesitas.

La estructura de la carga es la siguiente:

| Nombre         | Tipo         | Descripción                                               | Opcional |
| -------------- | ------------ | --------------------------------------------------------- | -------- |
| version        | string       | La versión del SDK que generó la carga                    | No       |
| \* packet      | object       | Contenidos, definidos por cada tipo de carga              | No       |
| signatures     | signature\[] | Firmas de carga por sesiones existentes                   | Sí       |
| packet.code    | string       | Identificador del tipo de carga                           | No       |
| packet.issued  | number       | Marca de tiempo de cuando se emitió la carga, en segundos | No       |
| packet.expires | number       | Marca de tiempo de cuando expirará la carga, en segundos  | No       |

\* packet debe estar organizado de manera que sus campos (en estructura JSON) aparezcan alfabéticamente por nombre.

> La cartera es opcional cuando se abre una nueva sesión

#### tipo de firma

| Nombre       | Tipo   | Descripción                           | Opcional |
| ------------ | ------ | ------------------------------------- | -------- |
| session      | string | Identificador de la sesión de firma   | No       |
| \* signature | string | Firma de la sesión para la carga dada | No       |

\* signature debe ser una firma EIP-191. Ver [https://eips.ethereum.org/EIPS/eip-191](https://eips.ethereum.org/EIPS/eip-191)

```json
{
  "version": "1.0.0",
  "packet": {
    "code": "signMessage",
    "expires": 1600086400,
    "issued": 1600000000,
    "message": "Join game: #284892",
    "network": "137",
    "wallet": "0xBc5F07A5852fdF3DBd57A76835109220D0ADd8E8"
  },
  "signatures": [{
    "session": "0xCF67BCbD9D5DFD373b03f4fc8143e1c6744B5696",
    "signature": "0x4b0fc0c7d42566958d60f92115ab95167c837c891e2f4fa62a75bfed30d86af7291051fe5c88985269286548a42bed5b70bb16588e48998206a2e7a547f527d101"
  }]
}
```

### Carga de apertura de sesión

Abrir una nueva sesión del lado del cliente en el SDK de la Cartera Integrada genera esta carga. Contiene la "prueba" que autentica al usuario y los datos de la sesión para vincularse a ella.

Ya sea `idToken`, `email` o una firma válida *DEBE* estar presente. Si `email` se proporciona, la Embedded Wallet enviará un correo electrónico al usuario en su primera transacción con esta sesión. El correo electrónico solicita su confirmación.

El `wallet` parámetro es opcional *SOLO* para esta carga útil. Si se proporciona, asegura que la sesión abierta coincida con la billetera solicitada.

| Nombre        | Tipo   | Descripción                                                      | Opcional |
| ------------- | ------ | ---------------------------------------------------------------- | -------- |
| code          | string | El "code" de la carga útil (`openSession`).                      | No       |
| session       | string | El identificador único para la sesión                            | No       |
| proof         | object | Contiene detalles de autenticación como JWT y correo electrónico | No       |
| proof.idToken | string | Token de id OAuth2                                               | Sí       |
| proof.email   | string | Dirección de correo electrónico del usuario                      | Sí       |

Ten en cuenta que ya sea `idToken`, `email` o una firma válida *DEBE* estar presente. Si `email` se proporciona, la Embedded Wallet enviará un correo electrónico en la primera transacción del usuario con esta sesión, solicitando su confirmación.

```json
{
  "version": "1.0.0",
  "packet": {
    "code": "openSession",
    "expires": 1600086400,
    "issued": 1600000000,
    "proof": {
      "idToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwOi8vbXktZG9tYWluLmF1dGgwLmNvbSIsInN1YiI6ImF1dGgwfDEyMzQ1NiIsImF1ZCI6IjEyMzRhYmNkZWYiLCJleHAiOjEzMTEyODE5NzAsImlhdCI6MTMxMTI4MDk3MCwibmFtZSI6IkphbmUgRG9lIiwiZ2l2ZW5fbmFtZSI6IkphbmUiLCJmYW1pbHlfbmFtZSI6IkRvZSJ9.bql-jxlG9B_bielkqOnjTY9Di9FillFb6IMQINXoYsw",
      "email": "user@email.com"
    },
    "session": "0xCF67BCbD9D5DFD373b03f4fc8143e1c6744B5696"
  }
}
```

### Carga útil de firma de mensaje

Esta carga útil se genera cuando `signMessage` se llama en el SDK.

| Nombre  | Tipo   | Descripción                                 | Opcional |
| ------- | ------ | ------------------------------------------- | -------- |
| code    | string | El "code" de la carga útil (`signMessage`). | No       |
| wallet  | string | Dirección de la billetera.                  | No       |
| network | string | Red en la que enviar las transacciones.     | No       |
| message | string | Mensaje a ser firmado.                      | No       |

```json
{
  "version": "1.0.0",
  "packet": {
    "code": "signMessage",
    "expires": 1600086400,
    "issued": 1600000000,
    "message": "Join game: #284892"
    "network": "1",
    "wallet": "0xBc5F07A5852fdF3DBd57A76835109220D0ADd8E8",
  },
  "signatures": [{
    "session": "0xCF67BCbD9D5DFD373b03f4fc8143e1c6744B5696",
    "signature": "0x4f9555c73908b6a5b61e0a744cb4e00fce7b20743d5799e4cb1774081bc6b2ec192c740e50f1adec84605636e09c9cdf4d2f6629f9ce64d8d0f3ae10305ef90400"
  }]
}
```

### Carga útil de envío de transacción

Esta carga útil se genera cuando `sendTransaction` se llama en el SDK.

| Nombre       | Tipo                                                                        | Descripción                                | Opcional |
| ------------ | --------------------------------------------------------------------------- | ------------------------------------------ | -------- |
| code         | string                                                                      | El "code" del payload (`sendTransaction`). | No       |
| identifier   | string                                                                      | Identificador único para la transacción    | No       |
| wallet       | string                                                                      | Dirección de la wallet.                    | No       |
| network      | string                                                                      | Red en la que enviar las transacciones.    | No       |
| transactions | (transaction \| erc20send \| erc721send \| erc1155send \| delayedEncode)\[] | Array de objetos de transacción.           | No       |

#### Transacción sin procesar

| Nombre | Tipo   | Descripción                                 | Opcional |
| ------ | ------ | ------------------------------------------- | -------- |
| type   | string | Tipo de transacción, debe ser "transaction" | No       |
| to     | string | La dirección Ethereum del destinatario      | No       |
| value  | string | El valor a ser transferido                  | Sí       |
| data   | string | Datos adicionales para la transacción       | Sí       |

Ten en cuenta que las transacciones con `to === wallet` están estrictamente prohibidas y serán rechazadas.

#### sendERC20

| Nombre | Tipo   | Descripción                               | Opcional |
| ------ | ------ | ----------------------------------------- | -------- |
| type   | string | Tipo de transacción, debe ser "erc20send" | No       |
| token  | string | La dirección del contrato del token ERC20 | No       |
| to     | string | La dirección Ethereum del destinatario    | No       |
| value  | string | Cantidad de tokens a enviar               | No       |

#### sendERC721

| Nombre | Tipo   | Descripción                                 | Opcional |
| ------ | ------ | ------------------------------------------- | -------- |
| type   | string | Tipo de transacción, debe ser "erc721send"  | No       |
| token  | string | La dirección del contrato del token ERC721  | No       |
| to     | string | La dirección Ethereum del destinatario      | No       |
| id     | string | ID del token a enviar                       | No       |
| safe   | bool   | Si se debe usar la función safeTransferFrom | Sí       |
| data   | string | Datos adicionales para la transacción       | Sí       |

Ten en cuenta que `data` solo se puede usar si `safe === true`.

#### sendERC1155

| Nombre         | Tipo      | Descripción                                 | Opcional |
| -------------- | --------- | ------------------------------------------- | -------- |
| type           | string    | Tipo de transacción, debe ser "erc1155send" | No       |
| token          | string    | La dirección del contrato del token ERC1155 | No       |
| to             | string    | La dirección Ethereum del destinatario      | No       |
| vals           | object\[] | Array de objetos con id y cantidad          | No       |
| vals\[].id     | string    | El ID del token                             | No       |
| vals\[].amount | string    | Cantidad de tokens con este ID para enviar  | No       |
| data           | string    | Datos adicionales para la transacción       | Sí       |

#### delayedEncode

Las transacciones de codificación retardada tienen sus datos de carga útil no codificados en el cliente, en su lugar se dejan para ser codificados por la API de Embedded Wallet. Esto reduce la carga en el cliente y facilita la integración en entornos con bibliotecas limitadas.

| Tipo                   | Campo | Tipo de Dato                                                                           | Descripción                                                                        |
| ---------------------- | ----- | -------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- |
| DelayedEncodeData      | abi   | string                                                                                 | El ABI (Interfaz Binaria de Aplicación) para el contrato.                          |
|                        | func  | string                                                                                 | La función a llamar dentro del contrato inteligente.                               |
|                        | args  | (string \| DelayedEncodeData)\[] \| \{ \[key: string]: (string \| DelayedEncodeData) } | Los argumentos para pasar a la función. Puede ser un array o un objeto.            |
| DelayedEncodeSubpacket | type  | 'delayedEncode'                                                                        | El tipo del subpaquete, en este caso, es `'delayedEncode'`.                        |
|                        | to    | string                                                                                 | La dirección a la que se envía la transacción.                                     |
|                        | value | string                                                                                 | El valor que se envía en la transacción, generalmente en Ether para Ethereum.      |
|                        | data  | DelayedEncodeData                                                                      | La carga útil de datos, que contiene el ABI, la función a llamar y los argumentos. |

¡Espero que esto ayude!

```json
{
  "version": "1.0.0",
  "packet": {
    "code": "sendTransaction",
    "expires": 1600086400,
    "identifier": "tx-id1-1600000000",
    "issued": 1600000000,
    "network": "137",
    "transactions": [
      {
        "data": "0x3251ba32",
        "to": "0x479F6a5b0C1728947318714963a583C56A78366A",
        "type": "transaction",
        "value": "39381"
      },
      {
        "to": "0x7b1Bd3474D789e18e2E329E2c53F819B6E687b4A",
        "token": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
        "type": "erc20send",
        "value": "1000"
      },
      {
        "data": "0x112233",
        "id": "7",
        "safe": true,
        "to": "0x17fFA2d95b58228e1ECb0C6Ac25A6EfD20BA08E4",
        "token": "0xF87E31492Faf9A91B02Ee0dEAAd50d51d56D5d4d",
        "type": "erc721send"
      },
      {
        "data": "0x223344",
        "to": "0x91E8aC543C5fEDf9F3Ef8b9dA1500dB84305681F",
        "token": "0x631998e91476da5b870d741192fc5cbc55f5a52e",
        "type": "erc1155send",
        "vals": [{
          "amount": "5",
          "id": "2"
        }, {
          "amount": "1",
          "id": "500"
        }]
      },
			{
				"data": {
					"abi": "[{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_orderId\",\"type\":\"bytes32\"},{\"internalType\":\"uint256\",\"name\":\"_maxCost\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"_fees\",\"type\":\"address\"},{\"internalType\":\"bytes\",\"name\":\"_data\",\"type\":\"bytes\"}],\"name\":\"fillOrKillOrder\",\"outputs\":[],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"otherMethods\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]",
					"args": [
						"0x6bd55a2877890bd58871eefe886770a7734077a74981910a75d7b1f044b5bf28",
						"1000000000000000000",
						"[\"0x095aE61E8207C7856eA273235D6BAdb69d815F5e\", \"0xC9D9B33231d24dd8cC53fDD64F7ABdd156f2a7E2\"]",
						{
							"abi": "notExpired(uint256,string)",
							"args": [
								"1600000000",
								"Nov 1st, 2020"
							],
							"func": "notExpired"
						}
					],
					"func": "fillOrKillOrder"
				},
        "to": "0x140d72763D1ce39Ad4E2e73EC6e8FC53E5b73B64",
				"type": "delayedEncode",
        "value": "0"
			}
    ],
    "wallet": "0xBc5F07A5852fdF3DBd57A76835109220D0ADd8E8"
  },
  "signatures": [{
    "session": "0xCF67BCbD9D5DFD373b03f4fc8143e1c6744B5696",
    "signature": "0x4f9555c73908b6a5b61e0a744cb4e00fce7b20743d5799e4cb1774081bc6b2ec192c740e50f1adec84605636e09c9cdf4d2f6629f9ce64d8d0f3ae10305ef90400"
  }]
}
```

### Payload de cierre de sesión

Este payload se genera cuando el cliente solicita cerrar una sesión determinada. Ten en cuenta que el cliente *PUEDE* cerrar la sesión actual u otra sesión.

| Nombre  | Tipo   | Descripción                               | Opcional |
| ------- | ------ | ----------------------------------------- | -------- |
| code    | string | El "code" del payload (`closeSession`).   | No       |
| wallet  | string | Dirección de la billetera.                | No       |
| session | string | Identificador de la sesión que se cerrará | No       |

```json
{
  "version": "1.0.0",
  "packet": {
    "code": "closeSession",
    "expires": 1600086400,
    "issued": 1600000000,
    "session": "0xCF67BCbD9D5DFD373b03f4fc8143e1c6744B5696",
    "wallet": "0xBc5F07A5852fdF3DBd57A76835109220D0ADd8E8"
  },
  "signatures": [{
    "session": "0xCF67BCbD9D5DFD373b03f4fc8143e1c6744B5696",
    "signature": "0x4f9555c73908b6a5b61e0a744cb4e00fce7b20743d5799e4cb1774081bc6b2ec192c740e50f1adec84605636e09c9cdf4d2f6629f9ce64d8d0f3ae10305ef90400"
  }]
}
```
