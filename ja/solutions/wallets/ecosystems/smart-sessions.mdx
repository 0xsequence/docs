---
title: Smart Sessions
description: SequenceのSmart Sessionsは、ウォレットのポップアップを減らし、ユーザー体験を向上させることで、dAppとのシームレスなやり取りを実現します。
---

## 現在のWeb3 UXの課題
今のWeb3では、ユーザー体験が頻繁に中断されます。スワップや出品、ちょっとした操作ごとにウォレットのポップアップが表示され、「署名」や承認を求められます。これが摩擦となり、普段使っているスムーズなアプリに比べてdAppが使いづらく感じられる原因です。

## Smart Sessionsとは？
**Smart Sessionsは、この課題を解決する仕組みです。**

Smart Sessionとは、dAppに対して一時的かつ厳格に制限された権限を安全に付与する仕組みです。すべてのトランザクションを毎回承認する代わりに、セッションを一度だけ承認することで、dAppが事前に合意した範囲の操作を自動で実行できるようになります。これにより、ポップアップが繰り返し表示されることなく、Web2のようなスムーズな体験を実現しつつ、セキュリティや自己管理も損ないません。

> 💡 **イメージしやすく言えば：** メインのウォレット署名鍵（マスターキー）を丸ごと渡すのではなく、明確なルールと制限が付いた特別なキーカードをアプリに渡すようなものです。

## 2種類のSmart Sessions
Sequenceは、用途に応じて2種類のSmart Sessionsを提供しています。
- **Implicit Sessions：** 信頼できる単一dApp内での最大限の利便性向け。
- **Explicit Sessions：** あらゆるオンチェーン操作に対する強力かつ細かな制御向け。

---

## 1. Implicit Sessions：「アプリ内利便パス」
Implicit Sessionは、最もシンプルで一般的なSmart Sessionです。主な目的は、単一のdApp内での体験をできる限りスムーズにすることです。

![Implicit Session](/images/implicit-diagram.png)

### 🎯 基本コンセプト
信頼できるdAppに接続すると、そのdAppのウェブサイトドメインを中心に「信頼の境界」が作られます。Implicit Sessionは、そのdApp内だけで自由に操作できるパスを発行します。

### ⚙️ 仕組み

1. **接続＆信頼：** ウォレットをdApp（例：`app.my-defi-protocol.com`）に接続します。
2. **サイレント承認：** セッションは自動的かつサイレントに、その特定ドメインに暗号的にロックされた状態で作成され、ユーザーの承認操作は不要です。
3. **シームレスな体験：** そのdApp内では、スワップやステーキング、出品など、どんな操作も追加のポップアップなしで実行できます。まさに「そのまま使える」感覚です。

### 🔒 セキュリティの仕組み
このセッションは他の場所では無効です。もしdAppが悪意を持ち、このセッションで他ドメインのコントラクト（例：USDCコントラクト）を呼び出そうとした場合、トランザクションは自動的にオンチェーンで拒否されます。セッションはdApp自身のスマートコントラクトにのみ有効です。
dAppは[Sequence Builder](https://sequence.build)で権限を設定します。

### 📊 Implicit Sessionsのポイント

| 項目        | 詳細                                               |
| --------- | ------------------------------------------------ |
| **最適な用途** | 単一dAppの日常利用（DeFiプロトコル、マーケットプレイス、ゲームなど）           |
| **主な特徴**  | 最大限の利便性。信頼できるdApp内で全ての署名ポップアップを排除。               |
| **たとえ話**  | 特定の建物専用のキーカード。建物内のすべての部屋を自由に移動できるが、隣の建物のドアは開かない。 |

---

## 2. Explicit Sessions：「プログラム可能な許可証」
Explicit Sessionは、より高度で強力なツールです。dAppが外部プロトコルと連携する特定の作業を行う必要がある場合に使われます。

![Explicit Session](/images/explicit-diagram.png)

### 🎯 基本コンセプト
dAppやそのスマートコントラクト全体を信頼するのではなく、一時的な署名者に対して正確なルールのリストを承認します。どこで、何が、いくらまで、どの期間、どのコントラクトで実行できるかを明確に定めたカスタム許可証を作成します。

### ⚙️ 仕組み

1.  **dAppが「契約書」を提案：** dAppがウォレットに、必要な具体的な権限リストを提示します。例：
    - 「`USDCコントラクト`の`transfer`関数を呼び出すことを許可してください。」
    - 「…`recipient`アドレスは`0x...`のみ」
    - 「…合計で最大`100`USDCまで」
    - 「…この権限は`24時間`で失効します。」

2.  **ユーザーが明示的にルールを承認：** ウォレットがこれらのルールを人間が読める形で表示します。ユーザーは内容を確認し、この条件セットを承認します。

3.  **dAppが実行：** dAppは、その範囲内の操作を自動で、ポップアップなしで実行できます。

### 🔒 セキュリティの仕組み
Explicit Sessionsの強みは、その細かさにあります。各ルールはオンチェーンで検証されます。dAppが承認範囲外の操作（例：100USDCではなく101USDCを使う、`transfer`ではなく`approve`を呼ぶ等）をしようとすると、トランザクションは失敗します。

### 📊 Explicit Sessionsのポイント

| 項目        | 詳細                                                                                             |
| --------- | ---------------------------------------------------------------------------------------------- |
| **最適な用途** | 特定の自動化・高額操作の承認（例：自動イールド収穫、NFT入札、定期支払い設定）やポップアップゼロ体験                                            |
| **主な特徴**  | 細かなプログラム可能な制御。dAppに許可する範囲を正確に定義可能。                                                             |
| **たとえ話**  | 事前承認済みの小切手のようなもの。特定の相手（target）に、正確な金額（valueLimit）で、「入金専用」などのメモ（rules）付きで発行。銀行はこれらのルールを厳格に守ります。 |