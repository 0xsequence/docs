---
title: トラストコントラクトのリカバリーフロー
description: トラストコントラクトのリカバリーフローのドキュメントは、Sequence WaaSアカウントを保護するトラストコントラクトのアーキテクチャの詳細を説明します。
sidebarTitle: トラストコントラクトのリカバリーフロー
---

トラストは、Sequence WaaSアカウントを保護する災害復旧コントラクトです。このドキュメントでは、トラストコントラクトの機能と災害時のリカバリーフローについて説明します。

## トラストコントラクトのアーキテクチャ

トラストは、タイムロックコントラクトで、各WaaSテナントプロジェクトに2つのインスタンスがあります。1つはプロジェクトのリカバリーウォレットに、もう1つはSequenceリカバリーウォレットにあります。トラストコントラクトは、ロック状態で開始され、テナント設定下のWaaSアカウントへのアクセスを拒否します。

制御当事者は、相手方のトラストコントラクトインスタンスでsetUnlocksAtメソッドを呼び出すことで、トラストコントラクトをアンロックできます。この操作により、トラストコントラクトインスタンスはカウントダウン状態になり、公開可能な90日間のカウントダウンが開始されます。

カウントダウン後、setUnlocksAtを呼び出した当事者は相手のトラストインスタンスを制御できるようになります。両方のインスタンスを制御することで、WaaSテナント設定で作成されたすべてのアカウントにアクセスできるようになります。

## アンロック状態の監視

Sequenceは、すべてのトラストコントラクトインスタンスのアンロック状態を監視しています。このサービスは、AWS Nitroセキュアエンクレーブインスタンスにデプロイされた既存のSequence WaaSの下で動作します。監視システムは、すべてのトラストコントラクトインスタンスをチェックし、コントラクトでアンロック状態が検出された場合、Sequenceチームとプロジェクト所有者の両方に警告を発します。これにより、一方の当事者が相手のコントラクトでsetUnlocksAtを呼び出すことを、相手に知られることなく実行することを防ぎます。

## 災害復旧フロー

トラストコントラクトは、当事者が消失しWaaS設定アカウントへのアクセスが失われた場合にアカウントを回復します。この場合、相手方は相手のトラストコントラクトインスタンスでsetUnlocksAtメソッドを呼び出すことでリカバリーフローを開始できます。これにより、カウントダウンが終了するまで両当事者にアンロック通知が送信されます。90日間のカウントダウン後、作成されたアカウントとアカウント内のトークンを回復することが可能になります。
