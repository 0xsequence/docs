---
title: useWaasFeeOptions
description: ガス支払いのためのWaaS手数料オプションを処理するためのフック
sidebarTitle: useWaasFeeOptions
---

## インポート

```tsx
import { useWaasFeeOptions } from '@0xsequence/connect'
```

## 使用方法

```tsx
import { useWaasFeeOptions } from '@0xsequence/connect'
import { useEffect, useState } from 'react'

function App() {
  // Use the hook with default balance checking
  // This will return the wallet balance for each fee option
  const [
    pendingFeeOptionConfirmation,
    confirmPendingFeeOption,
    rejectPendingFeeOption
  ] = useWaasFeeOptions()
  
  // Or skip balance checking if needed
  // const [pendingFeeOptionConfirmation, confirmPendingFeeOption, rejectPendingFeeOption] =
  //   useWaasFeeOptions({ skipFeeBalanceCheck: true })
  
  const [selectedFeeOptionTokenName, setSelectedFeeOptionTokenName] = useState<string>()
  
  // Initialize with first option when fee options become available
  useEffect(() => {
    if (pendingFeeOptionConfirmation) {
      console.log('Pending fee options: ', pendingFeeOptionConfirmation.options)
      
      // You could select the first fee option by default
      if (pendingFeeOptionConfirmation.options.length > 0) {
        const firstOption = pendingFeeOptionConfirmation.options[0]
        setSelectedFeeOptionTokenName(firstOption.token.symbol)
      }
    }
  }, [pendingFeeOptionConfirmation])
  
  // Handle fee option selection and confirmation
  const handleConfirmFee = (tokenAddress: string | null) => {
    if (pendingFeeOptionConfirmation) {
      confirmPendingFeeOption(pendingFeeOptionConfirmation.id, tokenAddress)
    }
  }
  
  // Handle fee option rejection
  const handleRejectFee = () => {
    if (pendingFeeOptionConfirmation) {
      rejectPendingFeeOption(pendingFeeOptionConfirmation.id)
    }
  }
  
  // Render fee options UI
  if (pendingFeeOptionConfirmation) {
    return (
      <div>
        <h2>Select Fee Payment Token</h2>
        <div>
          {pendingFeeOptionConfirmation.options.map((option) => (
            <div key={option.token.symbol || option.token.contractAddress}>
              <input
                type="radio"
                name="feeOption"
                checked={selectedFeeOptionTokenName === option.token.symbol}
                onChange={() => setSelectedFeeOptionTokenName(option.token.symbol)}
              />
              <label>
                {option.token.symbol} - {option.token.contractAddress ? 
                  option.token.contractAddress : 'Native Token'}
                {/* Display balance info if extended with balance data */}
                {'balanceFormatted' in option && 
                  ` (Balance: ${option.balanceFormatted} ${option.token.symbol})`}
              </label>
            </div>
          ))}
        </div>
        <div>
          <button onClick={() => handleConfirmFee(
            pendingFeeOptionConfirmation.options.find(
              opt => opt.token.symbol === selectedFeeOptionTokenName
            )?.token.contractAddress || null
          )}>
            Confirm
          </button>
          <button onClick={handleRejectFee}>Cancel</button>
        </div>
      </div>
    )
  }
  
  return <div>No pending fee confirmation</div>
}
```

## パラメータ

このフックは以下のプロパティを持つオプションの設定オブジェクトを受け取ります：

```tsx
interface WaasFeeOptionsConfig {
  skipFeeBalanceCheck?: boolean
}
```

| パラメータ                 | 型         | 説明                                      |
| --------------------- | --------- | --------------------------------------- |
| `skipFeeBalanceCheck` | `boolean` | トークン残高のチェックをスキップするかどうか (デフォルト: `false`) |

## 戻り値の型: `UseWaasFeeOptionsReturnType`

このフックは以下の要素を含むタプルを返します：

```tsx
type UseWaasFeeOptionsReturnType = [
  pendingFeeOptionConfirmation: WaasFeeOptionConfirmation | undefined,
  confirmPendingFeeOption: (id: string, feeTokenAddress: string | null) => void,
  rejectPendingFeeOption: (id: string) => void
]
```

### プロパティ

#### pendingFeeOptionConfirmation

`WaasFeeOptionConfirmation | undefined`

トランザクションが保留中の場合は現在の手数料確認の詳細を含むオブジェクト、または`undefined`トランザクションの確認が保留中でない場合。

```tsx
type WaasFeeOptionConfirmation = {
  id: string                                // Unique identifier for the fee confirmation
  options: FeeOptionExtended[] | FeeOption[] // Available fee options with balance information
  chainId: number                           // Chain ID where the transaction will be executed
}
```

When`skipFeeBalanceCheck`は`false`の場合、オプションは`FeeOptionExtended`型となり、残高情報が含まれます：

```tsx
type FeeOptionExtended = FeeOption & {
  balance: string               // Raw balance string
  balanceFormatted: string      // Formatted balance with proper decimals
  hasEnoughBalanceForFee: boolean // Indicates if wallet has enough balance
}
```

#### confirmPendingFeeOption

`(id: string, feeTokenAddress: string | null) => void`

選択された手数料オプションを確認する関数。

| パラメータ             | 型                | 説明                                           |
| ----------------- | ---------------- | -------------------------------------------- |
| `id`              | `string`         | 手数料確認ID                                      |
| `feeTokenAddress` | `string \| null` | 手数料支払いに使用するトークンのアドレス（ネイティブトークンの場合は`null`を使用） |

#### rejectPendingFeeOption

`(id: string) => void`

現在の手数料オプション選択を拒否する関数。

| パラメータ | 型        | 説明          |
| ----- | -------- | ----------- |
| `id`  | `string` | 拒否する手数料確認ID |

## 注意事項

このフックは、スポンサーされていないトランザクションのWaaS（Wallet as a Service）手数料オプションを処理する機能を提供します。

主な機能：

* ネイティブトークンとERC20トークンでトランザクションの利用可能な手数料オプションを取得
* 各手数料オプションのユーザーウォレット残高を自動的に取得（`skipFeeBalanceCheck`が`true`でない限り）
* ユーザーが希望する手数料トークンを選択可能
* 手数料選択の確認または拒否

このフックはSequence WaaSプロバイダーと統合して手数料確認リクエストを捕捉し、手数料トークンの選択を可能にするユーザーインターフェースを提供します。

フックの使用方法の詳細については、[ERC20でガス代を支払う](/sdk/web/guides/pay-gas-in-erc20)ガイドを参照してください。
