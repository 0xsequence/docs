{"version":3,"sources":["../src/index.ts","../src/rpc/proto/databeat.gen.ts","../src/rpc/proto/index.ts","../node_modules/.pnpm/@noble+hashes@1.5.0/node_modules/@noble/hashes/src/_assert.ts","../node_modules/.pnpm/@noble+hashes@1.5.0/node_modules/@noble/hashes/src/utils.ts","../node_modules/.pnpm/@noble+hashes@1.5.0/node_modules/@noble/hashes/src/_md.ts","../node_modules/.pnpm/@noble+hashes@1.5.0/node_modules/@noble/hashes/src/sha256.ts"],"sourcesContent":["import { DatabeatRpcClient, Auth, Event as DatabeatEvent, EventType } from './rpc/proto'\n\nexport type { Auth }\n\nimport { sha256 } from '@noble/hashes/sha256'\nimport { bytesToHex } from '@noble/hashes/utils'\n\nexport interface Event<K extends string = any> extends DatabeatEvent {\n  event: keyof typeof EventType | K\n}\n\n// Databeat tracker options. See defaults below.\n//\n// Common setups:\n//   a.) privacy preserving with user-tracking disabled. All user events\n//       will be sent as hashed user-ids on the client-side.\n//      - options: <defaultDatabeatOptions>, see below\n//\n//   b.) dual mode, privacy preserving + user-tracking, where privacy\n//       preserving mode is used but tracks user-ids if user has permitted\n//       it via `allowTracking(true)`.\n//       - options: { ..., userIdentTracking: true }\n//\n//   c.) classic / traditional tracking mode, user must permit or\n//       no events are sent.\n//       - options: { ..., strictMode: true }\n//\nexport interface DatabeatOptions {\n  // defaultEnabled will enable tracking by default. This field\n  // does not inform privacy preserving mode or not, see below.\n  //\n  // Default: true\n  defaultEnabled?: boolean\n\n  // project id related to the databeat events. This can be set\n  // at the options level and always used, of passed directly to an event.\n  projectId?: number\n\n  // privacy options of the user_id field to offer privacy-preserving\n  // tracking features. NOTE: there is an additional privacy-preserving\n  // parameter available on the databeat-server itself called `server_user_id_salt`\n  // which adds extra salt + hashes value before ingesting into the sink\n  // on the server side.\n  //\n  // Default: all privacy options are enabled.\n  privacy?: PrivacyOptions\n\n  // userIdentTracking will enable user tracking if the user has\n  // allowed it (see allowTracking() method). When disabled, the ident\n  // of a user will always remain private even if allowTracking(true)\n  // is called.\n  //\n  // Default: false\n  userIdentTracking?: boolean\n\n  // strictMode will require allowTracking(true) call before any events\n  // will be sent, including privacy preserving events.\n  //\n  // Default: false\n  strictMode?: boolean\n\n  // flushInterval is the time in milliseconds to wait before sending\n  // events to the sink server.\n  //\n  // Default: 500\n  flushInterval?: number\n\n  // noop will inform the tracker to skip sending events to the sink.\n  // this is similar to enable/disable, but its not persisted in storage.\n  // it also acts as an override and takes precedence over enable/disable.\n  noop?: boolean\n\n  // initProps is a function that returns a map of properties to be\n  // set on all events. This is useful for setting properties that\n  // are common to all events.\n  //\n  // Default: {}\n  initProps?: () => {}\n}\n\nexport interface PrivacyOptions {\n  userIdHash?: boolean\n  userAgentSalt?: boolean\n  extraSalt?: string\n}\n\nexport enum Ident {\n  ANON = 0,\n  PRIVATE = 1,\n  USER = 2,\n}\n\nconst MAX_QUEUE_SIZE = 150\n\nconst defaultDatabeatOptions: DatabeatOptions = {\n  defaultEnabled: true,\n  noop: false,\n  privacy: { userIdHash: true, userAgentSalt: false },\n  userIdentTracking: false,\n  strictMode: false,\n  flushInterval: 500,\n  initProps: () => {\n    return {}\n  },\n}\n\nexport class Databeat<K extends string> {\n  private rpc: DatabeatRpcClient\n  private auth: Auth\n  private options: DatabeatOptions\n  private enabled: boolean\n  private ident: Ident\n  private userId: string | null\n  private sessionId: string | null\n  private allowUserTracking: boolean\n  private projectId: number | null\n  private queue: Event<K>[]\n  private flushTimeout: NodeJS.Timeout | null\n  private defaultProps: {}\n  private dedupeIdentKey: string | null\n  private dedupeViewKey: string | null\n  private ts?: number\n\n  constructor(host: string, auth: Auth | string, options?: DatabeatOptions) {\n    if (typeof auth === 'string') {\n      this.auth = { jwt: auth }\n    } else {\n      this.auth = auth\n    }\n    this.rpc = new DatabeatRpcClient(host, this.auth)\n    this.options = defaultDatabeatOptions\n    if (options) {\n      this.options = {\n        defaultEnabled: options.defaultEnabled || defaultDatabeatOptions.defaultEnabled,\n        projectId: options.projectId || null,\n        privacy: options.privacy || defaultDatabeatOptions.privacy,\n        userIdentTracking: options.userIdentTracking || defaultDatabeatOptions.userIdentTracking,\n        strictMode: options.strictMode || defaultDatabeatOptions.strictMode,\n        flushInterval: options.flushInterval || defaultDatabeatOptions.flushInterval,\n        noop: options.noop || false,\n        initProps: options.initProps || defaultDatabeatOptions.initProps,\n      }\n    }\n    this.init()\n  }\n\n  // init is called on load by the constructor and also by reset().\n  private init() {\n    this.enabled = isEnabled(this.options.defaultEnabled, this.auth)\n    this.projectId = this.options.projectId || null\n    this.userId = null\n    this.sessionId = genSessionId()\n    this.queue = []\n    this.flushTimeout = null\n    this.defaultProps = { ...getDefaultProps(), ...this.options.initProps() }\n    this.identify()\n  }\n\n  // reset will reset the user_id and session_id details. Similar to a \"logout\" action.\n  reset(skipInit?: boolean) {\n    this.enabled = isEnabled(this.options.defaultEnabled, this.auth)\n    if (this.userId && !this.isAnon()) {\n      this.userId = null\n    }\n    this.ident = Ident.ANON\n    this.ts = setStorageVal({ on: this.enabled, id: this.userId, it: this.ident, ut: this.allowUserTracking })\n\n    if (skipInit === true) {\n      return\n    }\n    this.init()\n  }\n\n  // identify can be called to seed the userId, where the behaviour changes\n  // depending on privacy or strict modes. identify is also called on init,\n  // where we load the data from localStorage.\n  identify(userId?: string, options?: PrivacyOptions & { allowTracking?: boolean }) {\n    // skip method when used with node\n    if (!isBrowser()) return\n\n    // check if allow tracking option passed, which is a syntax sugar to calling\n    // allowTracking(..) method.\n    if (options && options.allowTracking !== undefined) {\n      this.allowTracking(options.allowTracking)\n    }\n\n    // attempt to find userId if one isn't provided\n    if (!userId) {\n      const val = getStorageVal()\n      if (val !== null && val.id !== null) {\n        this.userId = val.id\n        this.ident = val.it\n        this.allowUserTracking = val.ut\n\n        // migrate from earlier when `val.it` didn't exist\n        if (val.it === undefined) {\n          if (this.userId.startsWith('anon:')) {\n            this.ident = Ident.ANON\n          } else {\n            this.ident = Ident.PRIVATE\n          }\n          this.ts = setStorageVal({ on: this.enabled, id: this.userId, it: this.ident, ut: this.allowUserTracking })\n        } else {\n          this.ident = val.it\n        }\n      }\n    }\n\n    // update userId or gen new one\n    if (userId || this.userId === null) {\n      const v = genUserId(userId, this.allowUserTracking, this.options)\n      this.userId = v.userId\n      this.ident = v.ident\n      this.ts = setStorageVal({ on: this.enabled, id: this.userId, it: this.ident, ut: this.allowUserTracking })\n    }\n\n    // simple dedupe of consecutive calls to identify()\n    const dedupeIdentKey = `${this.userId}:${this.sessionId}`\n    if (this.dedupeIdentKey === dedupeIdentKey) return\n    this.dedupeIdentKey = dedupeIdentKey\n\n\n    // track init and flush it right away\n    this.track({ event: 'INIT', source: getPagePath(), props: this.defaultProps })\n\n    // flush queued events\n    // NOTE: we do not call this.trackView() at this point, as we expect the webapp to do so.\n    this.flush()\n  }\n\n  // allowTracking is used by strict mode to enable/disable tracking.\n  allowTracking(allowTracking: boolean) {\n    this.allowUserTracking = allowTracking\n    setStorageVal({ on: this.enabled, id: this.userId, it: this.ident, ut: this.allowUserTracking })\n\n    // in strict mode, we enable/disable tracking\n    if (this.options.strictMode) {\n      if (allowTracking) {\n        this.enable()\n      } else {\n        this.disable()\n      }\n    }\n  }\n\n  async track(events: Event<K> | Event<K>[], options?: { flush?: boolean }) {\n    if (isBrowser() && this.userId === null) {\n      throw new Error('databeat: init first')\n    }\n\n    if (Array.isArray(events)) {\n      for (let i = 0; i < events.length; i++) {\n        events[i].ident = this.ident\n        events[i].userId = this.userId\n        events[i].sessionId = this.sessionId\n        if (!events[i].projectId && this.projectId) {\n          events[i].projectId = this.projectId\n        }\n      }\n      this.queue.push(...events)\n    } else {\n      events.ident = this.ident\n      events.userId = this.userId\n      events.sessionId = this.sessionId\n      if (!events.projectId && this.projectId) {\n        events.projectId = this.projectId\n      }\n      this.queue.push(events)\n    }\n\n    // Limit the queue size\n    if (this.queue.length > MAX_QUEUE_SIZE) {\n      this.queue = this.queue.splice(this.queue.length - MAX_QUEUE_SIZE)\n    }\n\n    // flush\n    if (!this.enabled) return\n    if (options && options.flush) {\n      // flush events right away\n      await this.flush()\n    } else if (this.flushTimeout === null) {\n      // flush events in the future (which will auto-batch)\n      this.flushTimeout = setTimeout(() => {\n        this.flush()\n      }, this.options.flushInterval)\n    }\n  }\n\n  trackView(props: { [key: string]: string } = {}) {\n    const eventProps = { ...this.defaultProps, ...props }\n    const eventSource = getPagePath()\n\n    // simple dedupe -- skip if we're already on this page\n    // NOTE: even though we dedupe in the flush() method, we do it here in case of timing\n    // between flushes on the same page.\n    const pageKey = `${eventSource}:${JSON.stringify(eventProps)}:${this.userId}:${this.sessionId}`\n    if (this.dedupeViewKey === pageKey) return\n    this.dedupeViewKey = pageKey\n\n    // track the page view\n    this.track({ event: 'VIEW', source: eventSource, props: eventProps })\n  }\n\n  flush = async () => {\n    if (this.flushTimeout !== null) {\n      clearTimeout(this.flushTimeout)\n      this.flushTimeout = null\n    }\n\n    if (!this.enabled) return\n    if (this.options.noop) return\n    if (this.options.strictMode && !this.allowUserTracking) return\n    if (this.queue.length === 0) return\n\n    // dedupe the queue\n    const events = this.dedupedQueue()\n    this.queue = []\n\n    // send the events\n    try {\n      await this.rpc.tick({ events: events })\n    } catch (err) {\n      console.warn(`databeat flush failed: ${err}`)\n    }\n  }\n\n  isEnabled() {\n    return this.enabled\n  }\n\n  isAnon() {\n    return this.ident === Ident.ANON\n  }\n\n  getIdent() {\n    return this.ident\n  }\n\n  getUserId() {\n    return this.userId\n  }\n\n  getSessionId() {\n    return this.sessionId\n  }\n\n  getStorageTS(): number | undefined {\n    if (this.ts) {\n      return this.ts\n    }\n    const val = getStorageVal()\n    if (val === undefined || val === null || val.id === null) {\n      return undefined\n    }\n    this.ts = val.ts\n    return this.ts\n  }\n\n  enable() {\n    if (!isAuthEnabled(this.auth)) {\n      this.enabled = false\n      return\n    }\n    if (!isBrowser()) return\n    this.enabled = true\n    this.ts = setStorageVal({ on: this.enabled, id: this.userId, it: this.ident, ut: this.allowUserTracking })\n    this.identify()\n  }\n\n  disable() {\n    if (!isBrowser()) return\n    this.enabled = false\n    this.ts = setStorageVal({ on: this.enabled, id: this.userId, it: this.ident, ut: this.allowUserTracking })\n  }\n\n  private dedupedQueue = () => {\n    const uniqEvents = new Map()\n    for (let i = 0; i < this.queue.length; i++) {\n      const ev = this.queue[i]\n      const key = `${ev.event}:${ev.source}:${ev.userId}:${ev.sessionId}:${JSON.stringify(ev.props)}:${JSON.stringify(ev.nums)}`\n      if (!uniqEvents.has(key)) {\n        uniqEvents.set(key, ev)\n      }\n    }\n    return Array.from(uniqEvents.values())\n  }\n}\n\nexport const isBrowser = () => {\n  return (\n    typeof window === 'object' &&\n    typeof window.localStorage === 'object' &&\n    typeof window.localStorage.getItem === 'function' &&\n    typeof window.localStorage.setItem === 'function'\n  )\n}\n\nconst isEnabled = (defaultEnabled?: boolean, auth?: Auth) => {\n  if (!isAuthEnabled(auth)) {\n    return false\n  }\n  if (!isBrowser()) {\n    return true\n  }\n  const val = getStorageVal()\n  if (val === null) {\n    if (defaultEnabled !== null && defaultEnabled !== undefined) {\n      return defaultEnabled\n    } else {\n      return true\n    }\n  } else {\n    return val.on\n  }\n}\n\nconst isAuthEnabled = (auth?: Auth) => {\n  if (auth?.jwt?.length > 0) {\n    return true\n  }\n  if (auth?.headers && Object.keys(auth.headers).length > 0) {\n    return true\n  }\n  return false\n}\n\nconst getPagePath = () => {\n  try {\n    return window.location.pathname\n  } catch (err) {\n    return ''\n  }\n}\n\nconst getDefaultProps = () => {\n  if (!isBrowser()) return {}\n\n  const params = new URL(window.location.href).searchParams\n  const props = {}\n\n  props['origin'] = window.location.origin\n\n  if (params.get('ref') && params.get('ref') !== '') {\n    props['ref'] = params.get('ref') || ''\n  }\n  if (params.get('source') && params.get('source') !== '') {\n    props['source'] = params.get('source') || ''\n  }\n  if (params.get('utm_source') && params.get('utm_source') !== '') {\n    props['utmSource'] = params.get('utm_source') || ''\n  }\n  if (params.get('utm_campaign') && params.get('utm_campaign') !== '') {\n    props['utmCampaign'] = params.get('utm_campaign') || ''\n  }\n  if (params.get('utm_medium') && params.get('utm_medium') !== '') {\n    props['utmMedium'] = params.get('utm_medium') || ''\n  }\n  if (params.get('utm_content') && params.get('utm_content') !== '') {\n    props['utmContent'] = params.get('utm_content') || ''\n  }\n  if (params.get('utm_term') && params.get('utm_term') !== '') {\n    props['utmTerm'] = params.get('utm_term') || ''\n  }\n  if (document.referrer && document.referrer !== '') {\n    props['referrer'] = document.referrer\n  }\n  if (params.get('gclid') && params.get('gclid') !== '') {\n    props['gclid'] = params.get('gclid') || ''\n  }\n  if (params.get('wbraid') && params.get('wbraid') !== '') {\n    props['wbraid'] = params.get('wbraid') || ''\n  }\n\n  return props\n}\n\nconst storageKey = '_dbeat'\n\ninterface StorageVal {\n  on: boolean\n  id: string | null\n  it: Ident\n  ut: boolean | null\n  ts?: number\n}\n\nexport const getStorageVal = (): StorageVal | null => {\n  try {\n    return JSON.parse(window.localStorage.getItem(storageKey))\n  } catch (err) {\n    return null\n  }\n}\n\nconst setStorageVal = (val: StorageVal): number | undefined => {\n  try {\n    if (!val.ts) {\n      val.ts = Math.floor(Date.now() / 1000)\n    }\n    window.localStorage.setItem(storageKey, JSON.stringify(val))\n    return val.ts\n  } catch (err) {\n    return\n  }\n}\n\nexport const genUserId = (seed: string, allowUserTracking: boolean, options: DatabeatOptions) => {\n  // Generate user id based on random number\n  if (!seed || seed === null || seed === '') {\n    const id = Math.floor(Math.random() * 100000000000000)\n    return { userId: `${id}`, ident: Ident.ANON }\n  }\n\n  // in `userIdentTracking` mode when the user has allowed tracking,\n  // we can pass the user id as is, with ident of USER.\n  if (options.userIdentTracking && allowUserTracking) {\n    return { userId: seed, ident: Ident.USER }\n  }\n\n  // Generate user id based on hash of seed + optional extra salt\n  if (options.privacy.userIdHash === true || !options.userIdentTracking || !allowUserTracking) {\n    if (isBrowser() && options.privacy.userAgentSalt === true) {\n      seed = seed + ':' + navigator.userAgent\n    }\n    if (options.privacy.extraSalt && options.privacy.extraSalt.length > 0) {\n      seed = seed + ':' + options.privacy.extraSalt\n    }\n    return { userId: bytesToHex(sha256(seed)).substring(0, 50), ident: Ident.PRIVATE }\n  } else {\n    throw new Error('invalid configuration')\n  }\n}\n\nexport const genSessionId = () => {\n  const isSessionStorageAvail =\n    isBrowser() &&\n    typeof window.sessionStorage === 'object' &&\n    typeof window.sessionStorage.getItem === 'function' &&\n    typeof window.sessionStorage.setItem === 'function'\n\n  if (!isSessionStorageAvail) {\n    return genRandHex(16)\n  } else {\n    const sid = window.sessionStorage.getItem(storageKey)\n    if (!!sid && sid.length > 0) {\n      return sid\n    } else {\n      const sid = genRandHex(16)\n      window.sessionStorage.setItem(storageKey, sid)\n      return sid\n    }\n  }\n}\n\nconst genRandHex = (n: number) => {\n  let hexString = ''\n  for (let i = 0; i < n; i++) {\n    hexString += Math.floor(Math.random() * 16).toString(16)\n  }\n  return '0x' + hexString\n}\n\nif (typeof process === 'object' && process.version && process.version < 'v18') {\n  console.error(`ERROR! expecting node v18+ but your node version is reporting ${process.version}`)\n  if (process && process.exit) {\n    process.exit(1)\n  }\n}\n","/* eslint-disable */\n// databeat v0.1.0 f99550b11883527a9ba7db8f8371c616a50f0dd3\n// --\n// Code generated by webrpc-gen@v0.18.6 with typescript generator. DO NOT EDIT.\n//\n// webrpc-gen -schema=databeat.ridl -target=typescript -client -out=./clients/databeat.gen.ts\n\n// WebRPC description and code-gen version\nexport const WebRPCVersion = \"v1\"\n\n// Schema version of your RIDL schema\nexport const WebRPCSchemaVersion = \"v0.1.0\"\n\n// Schema hash generated from your RIDL schema\nexport const WebRPCSchemaHash = \"f99550b11883527a9ba7db8f8371c616a50f0dd3\"\n\n//\n// Types\n//\n\n\nexport enum EventType {\n  INIT = 'INIT',\n  VIEW = 'VIEW',\n  REQUEST = 'REQUEST'\n}\n\nexport enum Ident {\n  ANONYMOUS = 'ANONYMOUS',\n  PRIVATE = 'PRIVATE',\n  USER = 'USER',\n  SERVICE = 'SERVICE'\n}\n\nexport interface Version {\n  webrpcVersion: string\n  schemaVersion: string\n  schemaHash: string\n  appVersion: string\n}\n\nexport interface RuntimeStatus {\n  healthOK: boolean\n  startTime: string\n  uptime: number\n  ver: string\n  branch: string\n  commitHash: string\n  sinkStats: SinkStats\n  pipelineStats: {[key: string]: any}\n  gcpPubSub: boolean\n}\n\nexport interface SinkStats {\n  numEvents: number\n  numFails: number\n}\n\nexport interface App {\n  uid: string\n  name: string\n  domains: Array<string>\n  disabled: boolean\n}\n\nexport interface Event {\n  event: string\n  projectId?: number\n  source?: string\n  ident?: number\n  userId?: string\n  sessionId?: string\n  device?: Device\n  countryCode?: string\n  props?: {[key: string]: string}\n  nums?: {[key: string]: number}\n}\n\nexport interface Device {\n  type: string\n  os: string\n  osVersion: string\n  browser: string\n  browserVersion: string\n}\n\nexport interface RawEvent {\n  app?: string\n  ts?: string\n  event: string\n  projectId?: number\n  source: string\n  ident?: number\n  userId?: string\n  sessionId?: string\n  countryCode?: string\n  deviceType?: string\n  deviceOs?: string\n  deviceOsVersion?: string\n  deviceBrowser?: string\n  deviceBrowserVersion?: string\n  props?: {[key: string]: string}\n  nums?: {[key: string]: number}\n}\n\nexport interface Databeat {\n  ping(headers?: object, signal?: AbortSignal): Promise<PingReturn>\n  version(headers?: object, signal?: AbortSignal): Promise<VersionReturn>\n  runtimeStatus(headers?: object, signal?: AbortSignal): Promise<RuntimeStatusReturn>\n  tick(args: TickArgs, headers?: object, signal?: AbortSignal): Promise<TickReturn>\n  rawEvents(args: RawEventsArgs, headers?: object, signal?: AbortSignal): Promise<RawEventsReturn>\n}\n\nexport interface PingArgs {\n}\n\nexport interface PingReturn {\n  status: boolean  \n}\nexport interface VersionArgs {\n}\n\nexport interface VersionReturn {\n  version: Version  \n}\nexport interface RuntimeStatusArgs {\n}\n\nexport interface RuntimeStatusReturn {\n  status: RuntimeStatus  \n}\nexport interface TickArgs {\n  events: Array<Event>\n}\n\nexport interface TickReturn {\n  ok: boolean  \n}\nexport interface RawEventsArgs {\n  events: Array<RawEvent>\n}\n\nexport interface RawEventsReturn {\n  ok: boolean  \n}\n\nexport interface DatabeatAdmin {\n  listApps(headers?: object, signal?: AbortSignal): Promise<ListAppsReturn>\n  createApp(args: CreateAppArgs, headers?: object, signal?: AbortSignal): Promise<CreateAppReturn>\n  getApp(args: GetAppArgs, headers?: object, signal?: AbortSignal): Promise<GetAppReturn>\n  updateApp(args: UpdateAppArgs, headers?: object, signal?: AbortSignal): Promise<UpdateAppReturn>\n  disableApp(args: DisableAppArgs, headers?: object, signal?: AbortSignal): Promise<DisableAppReturn>\n}\n\nexport interface ListAppsArgs {\n}\n\nexport interface ListAppsReturn {\n  apps: Array<App>  \n}\nexport interface CreateAppArgs {\n  uid: string\n  name: string\n  domains: Array<string>\n}\n\nexport interface CreateAppReturn {\n  app: App  \n}\nexport interface GetAppArgs {\n  appUid: string\n}\n\nexport interface GetAppReturn {\n  app: App  \n}\nexport interface UpdateAppArgs {\n  app: App\n}\n\nexport interface UpdateAppReturn {\n  updated: boolean  \n}\nexport interface DisableAppArgs {\n  appUid: string\n  disabled: boolean\n}\n\nexport interface DisableAppReturn {\n  disabled: boolean  \n}\n\n\n  \n//\n// Client\n//\nexport class Databeat implements Databeat {\n  protected hostname: string\n  protected fetch: Fetch\n  protected path = '/rpc/Databeat/'\n\n  constructor(hostname: string, fetch: Fetch) {\n    this.hostname = hostname\n    this.fetch = (input: RequestInfo, init?: RequestInit) => fetch(input, init)\n  }\n\n  private url(name: string): string {\n    return this.hostname + this.path + name\n  }\n  \n  ping = (headers?: object, signal?: AbortSignal): Promise<PingReturn> => {\n    return this.fetch(\n      this.url('Ping'),\n      createHTTPRequest({}, headers, signal)\n      ).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          status: <boolean>(_data.status),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  version = (headers?: object, signal?: AbortSignal): Promise<VersionReturn> => {\n    return this.fetch(\n      this.url('Version'),\n      createHTTPRequest({}, headers, signal)\n      ).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          version: <Version>(_data.version),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  runtimeStatus = (headers?: object, signal?: AbortSignal): Promise<RuntimeStatusReturn> => {\n    return this.fetch(\n      this.url('RuntimeStatus'),\n      createHTTPRequest({}, headers, signal)\n      ).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          status: <RuntimeStatus>(_data.status),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  tick = (args: TickArgs, headers?: object, signal?: AbortSignal): Promise<TickReturn> => {\n    return this.fetch(\n      this.url('Tick'),\n      createHTTPRequest(args, headers, signal)).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          ok: <boolean>(_data.ok),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  rawEvents = (args: RawEventsArgs, headers?: object, signal?: AbortSignal): Promise<RawEventsReturn> => {\n    return this.fetch(\n      this.url('RawEvents'),\n      createHTTPRequest(args, headers, signal)).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          ok: <boolean>(_data.ok),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n}\nexport class DatabeatAdmin implements DatabeatAdmin {\n  protected hostname: string\n  protected fetch: Fetch\n  protected path = '/rpc/DatabeatAdmin/'\n\n  constructor(hostname: string, fetch: Fetch) {\n    this.hostname = hostname\n    this.fetch = (input: RequestInfo, init?: RequestInit) => fetch(input, init)\n  }\n\n  private url(name: string): string {\n    return this.hostname + this.path + name\n  }\n  \n  listApps = (headers?: object, signal?: AbortSignal): Promise<ListAppsReturn> => {\n    return this.fetch(\n      this.url('ListApps'),\n      createHTTPRequest({}, headers, signal)\n      ).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          apps: <Array<App>>(_data.apps),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  createApp = (args: CreateAppArgs, headers?: object, signal?: AbortSignal): Promise<CreateAppReturn> => {\n    return this.fetch(\n      this.url('CreateApp'),\n      createHTTPRequest(args, headers, signal)).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          app: <App>(_data.app),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  getApp = (args: GetAppArgs, headers?: object, signal?: AbortSignal): Promise<GetAppReturn> => {\n    return this.fetch(\n      this.url('GetApp'),\n      createHTTPRequest(args, headers, signal)).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          app: <App>(_data.app),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  updateApp = (args: UpdateAppArgs, headers?: object, signal?: AbortSignal): Promise<UpdateAppReturn> => {\n    return this.fetch(\n      this.url('UpdateApp'),\n      createHTTPRequest(args, headers, signal)).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          updated: <boolean>(_data.updated),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n  disableApp = (args: DisableAppArgs, headers?: object, signal?: AbortSignal): Promise<DisableAppReturn> => {\n    return this.fetch(\n      this.url('DisableApp'),\n      createHTTPRequest(args, headers, signal)).then((res) => {\n      return buildResponse(res).then(_data => {\n        return {\n          disabled: <boolean>(_data.disabled),\n        }\n      })\n    }, (error) => {\n      throw WebrpcRequestFailedError.new({ cause: `fetch(): ${error.message || ''}` })\n    })\n  }\n  \n}\n\n  const createHTTPRequest = (body: object = {}, headers: object = {}, signal: AbortSignal | null = null): object => {\n  return {\n    method: 'POST',\n    headers: { ...headers, 'Content-Type': 'application/json' },\n    body: JSON.stringify(body || {}),\n    signal\n  }\n}\n\nconst buildResponse = (res: Response): Promise<any> => {\n  return res.text().then(text => {\n    let data\n    try {\n      data = JSON.parse(text)\n    } catch(error) {\n      let message = ''\n      if (error instanceof Error)  {\n        message = error.message\n      }\n      throw WebrpcBadResponseError.new({\n        status: res.status,\n        cause: `JSON.parse(): ${message}: response text: ${text}`},\n      )\n    }\n    if (!res.ok) {\n      const code: number = (typeof data.code === 'number') ? data.code : 0\n      throw (webrpcErrorByCode[code] || WebrpcError).new(data)\n    }\n    return data\n  })\n}\n\n//\n// Errors\n//\n\nexport class WebrpcError extends Error {\n  name: string\n  code: number\n  message: string\n  status: number\n  cause?: string\n\n  /** @deprecated Use message instead of msg. Deprecated in webrpc v0.11.0. */\n  msg: string\n\n  constructor(name: string, code: number, message: string, status: number, cause?: string) {\n    super(message)\n    this.name = name || 'WebrpcError'\n    this.code = typeof code === 'number' ? code : 0\n    this.message = message || `endpoint error ${this.code}`\n    this.msg = this.message\n    this.status = typeof status === 'number' ? status : 0\n    this.cause = cause\n    Object.setPrototypeOf(this, WebrpcError.prototype)\n  }\n\n  static new(payload: any): WebrpcError {\n    return new this(payload.error, payload.code, payload.message || payload.msg, payload.status, payload.cause)\n  }\n}\n\n// Webrpc errors\n\nexport class WebrpcEndpointError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcEndpoint',\n    code: number = 0,\n    message: string = 'endpoint error',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcEndpointError.prototype)\n  }\n}\n\nexport class WebrpcRequestFailedError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcRequestFailed',\n    code: number = -1,\n    message: string = 'request failed',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcRequestFailedError.prototype)\n  }\n}\n\nexport class WebrpcBadRouteError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcBadRoute',\n    code: number = -2,\n    message: string = 'bad route',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcBadRouteError.prototype)\n  }\n}\n\nexport class WebrpcBadMethodError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcBadMethod',\n    code: number = -3,\n    message: string = 'bad method',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcBadMethodError.prototype)\n  }\n}\n\nexport class WebrpcBadRequestError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcBadRequest',\n    code: number = -4,\n    message: string = 'bad request',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcBadRequestError.prototype)\n  }\n}\n\nexport class WebrpcBadResponseError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcBadResponse',\n    code: number = -5,\n    message: string = 'bad response',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcBadResponseError.prototype)\n  }\n}\n\nexport class WebrpcServerPanicError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcServerPanic',\n    code: number = -6,\n    message: string = 'server panic',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcServerPanicError.prototype)\n  }\n}\n\nexport class WebrpcInternalErrorError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcInternalError',\n    code: number = -7,\n    message: string = 'internal error',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcInternalErrorError.prototype)\n  }\n}\n\nexport class WebrpcClientDisconnectedError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcClientDisconnected',\n    code: number = -8,\n    message: string = 'client disconnected',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcClientDisconnectedError.prototype)\n  }\n}\n\nexport class WebrpcStreamLostError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcStreamLost',\n    code: number = -9,\n    message: string = 'stream lost',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcStreamLostError.prototype)\n  }\n}\n\nexport class WebrpcStreamFinishedError extends WebrpcError {\n  constructor(\n    name: string = 'WebrpcStreamFinished',\n    code: number = -10,\n    message: string = 'stream finished',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, WebrpcStreamFinishedError.prototype)\n  }\n}\n\n\n// Schema errors\n\nexport class UnauthorizedError extends WebrpcError {\n  constructor(\n    name: string = 'Unauthorized',\n    code: number = 1000,\n    message: string = 'Unauthorized access',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, UnauthorizedError.prototype)\n  }\n}\n\nexport class PermissionDeniedError extends WebrpcError {\n  constructor(\n    name: string = 'PermissionDenied',\n    code: number = 2000,\n    message: string = 'Permission denied',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, PermissionDeniedError.prototype)\n  }\n}\n\nexport class SessionExpiredError extends WebrpcError {\n  constructor(\n    name: string = 'SessionExpired',\n    code: number = 2001,\n    message: string = 'Session expired',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, SessionExpiredError.prototype)\n  }\n}\n\nexport class NotFoundError extends WebrpcError {\n  constructor(\n    name: string = 'NotFound',\n    code: number = 3000,\n    message: string = 'Resource not found',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, NotFoundError.prototype)\n  }\n}\n\nexport class InvalidAppKeyError extends WebrpcError {\n  constructor(\n    name: string = 'InvalidAppKey',\n    code: number = 4000,\n    message: string = 'Invalid app key',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, InvalidAppKeyError.prototype)\n  }\n}\n\nexport class QueryFailedError extends WebrpcError {\n  constructor(\n    name: string = 'QueryFailed',\n    code: number = 4001,\n    message: string = 'DB query failed',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, QueryFailedError.prototype)\n  }\n}\n\nexport class InvalidProjectIdError extends WebrpcError {\n  constructor(\n    name: string = 'InvalidProjectId',\n    code: number = 4002,\n    message: string = 'Invalid project id',\n    status: number = 0,\n    cause?: string\n  ) {\n    super(name, code, message, status, cause)\n    Object.setPrototypeOf(this, InvalidProjectIdError.prototype)\n  }\n}\n\n\nexport enum errors {\n  WebrpcEndpoint = 'WebrpcEndpoint',\n  WebrpcRequestFailed = 'WebrpcRequestFailed',\n  WebrpcBadRoute = 'WebrpcBadRoute',\n  WebrpcBadMethod = 'WebrpcBadMethod',\n  WebrpcBadRequest = 'WebrpcBadRequest',\n  WebrpcBadResponse = 'WebrpcBadResponse',\n  WebrpcServerPanic = 'WebrpcServerPanic',\n  WebrpcInternalError = 'WebrpcInternalError',\n  WebrpcClientDisconnected = 'WebrpcClientDisconnected',\n  WebrpcStreamLost = 'WebrpcStreamLost',\n  WebrpcStreamFinished = 'WebrpcStreamFinished',\n  Unauthorized = 'Unauthorized',\n  PermissionDenied = 'PermissionDenied',\n  SessionExpired = 'SessionExpired',\n  NotFound = 'NotFound',\n  InvalidAppKey = 'InvalidAppKey',\n  QueryFailed = 'QueryFailed',\n  InvalidProjectId = 'InvalidProjectId',\n}\n\nconst webrpcErrorByCode: { [code: number]: any } = {\n  [0]: WebrpcEndpointError,\n  [-1]: WebrpcRequestFailedError,\n  [-2]: WebrpcBadRouteError,\n  [-3]: WebrpcBadMethodError,\n  [-4]: WebrpcBadRequestError,\n  [-5]: WebrpcBadResponseError,\n  [-6]: WebrpcServerPanicError,\n  [-7]: WebrpcInternalErrorError,\n  [-8]: WebrpcClientDisconnectedError,\n  [-9]: WebrpcStreamLostError,\n  [-10]: WebrpcStreamFinishedError,\n  [1000]: UnauthorizedError,\n  [2000]: PermissionDeniedError,\n  [2001]: SessionExpiredError,\n  [3000]: NotFoundError,\n  [4000]: InvalidAppKeyError,\n  [4001]: QueryFailedError,\n  [4002]: InvalidProjectIdError,\n}\n\nexport type Fetch = (input: RequestInfo, init?: RequestInit) => Promise<Response>\n\n","import { Databeat as DatabeatRpc } from './databeat.gen'\nexport type { EventType, Event, Device, RawEvent } from './databeat.gen'\n\nexport interface Auth {\n  jwt?: string\n  headers?: { [key: string]: string }\n}\n\nexport class DatabeatRpcClient extends DatabeatRpc {\n  private _globalFetch: any\n\n  constructor(hostname: string, public auth?: Auth) {\n    const globalFetch = globalThis.fetch.bind(globalThis)\n\n    super(hostname.endsWith('/') ? hostname.slice(0, -1) : hostname, globalFetch)\n\n    this._globalFetch = globalFetch\n    this.fetch = this._fetch\n  }\n\n  _fetch = (input: RequestInfo, init?: RequestInit): Promise<Response> => {\n    // automatically include jwt auth header to requests\n    // if its been set on the api client\n    if (this.auth) {\n      let headers: { [key: string]: any } = {}\n      if (this.auth.jwt?.length > 0) {\n        headers['Authorization'] = `BEARER ${this.auth.jwt}`\n      }\n\n      // set other custom auth headers\n      if (this.auth.headers) {\n        headers = { ...headers, ...this.auth.headers }\n      }\n\n      // before the request is made\n      init!.headers = { ...init!.headers, ...headers }\n    }\n\n    return this._globalFetch(input, init)\n  }\n}\n","function number(n: number) {\n  if (!Number.isSafeInteger(n) || n < 0) throw new Error(`positive integer expected, not ${n}`);\n}\n\nfunction bool(b: boolean) {\n  if (typeof b !== 'boolean') throw new Error(`boolean expected, not ${b}`);\n}\n\n// copied from utils\nexport function isBytes(a: unknown): a is Uint8Array {\n  return (\n    a instanceof Uint8Array ||\n    (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array')\n  );\n}\n\nfunction bytes(b: Uint8Array | undefined, ...lengths: number[]) {\n  if (!isBytes(b)) throw new Error('Uint8Array expected');\n  if (lengths.length > 0 && !lengths.includes(b.length))\n    throw new Error(`Uint8Array expected of length ${lengths}, not of length=${b.length}`);\n}\n\ntype Hash = {\n  (data: Uint8Array): Uint8Array;\n  blockLen: number;\n  outputLen: number;\n  create: any;\n};\nfunction hash(h: Hash) {\n  if (typeof h !== 'function' || typeof h.create !== 'function')\n    throw new Error('Hash should be wrapped by utils.wrapConstructor');\n  number(h.outputLen);\n  number(h.blockLen);\n}\n\nfunction exists(instance: any, checkFinished = true) {\n  if (instance.destroyed) throw new Error('Hash instance has been destroyed');\n  if (checkFinished && instance.finished) throw new Error('Hash#digest() has already been called');\n}\nfunction output(out: any, instance: any) {\n  bytes(out);\n  const min = instance.outputLen;\n  if (out.length < min) {\n    throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n  }\n}\n\nexport { number, bool, bytes, hash, exists, output };\n\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nimport { bytes as abytes } from './_assert.js';\n// export { isBytes } from './_assert.js';\n// We can't reuse isBytes from _assert, because somehow this causes huge perf issues\nexport function isBytes(a: unknown): a is Uint8Array {\n  return (\n    a instanceof Uint8Array ||\n    (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array')\n  );\n}\n\n// prettier-ignore\nexport type TypedArray = Int8Array | Uint8ClampedArray | Uint8Array |\n  Uint16Array | Int16Array | Uint32Array | Int32Array;\n\n// Cast array to different type\nexport const u8 = (arr: TypedArray) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr: TypedArray) =>\n  new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n\n// Cast array to view\nexport const createView = (arr: TypedArray) =>\n  new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word: number, shift: number) => (word << (32 - shift)) | (word >>> shift);\n// The rotate left (circular left shift) operation for uint32\nexport const rotl = (word: number, shift: number) =>\n  (word << shift) | ((word >>> (32 - shift)) >>> 0);\n\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\n// The byte swap operation for uint32\nexport const byteSwap = (word: number) =>\n  ((word << 24) & 0xff000000) |\n  ((word << 8) & 0xff0000) |\n  ((word >>> 8) & 0xff00) |\n  ((word >>> 24) & 0xff);\n// Conditionally byte swap if on a big-endian platform\nexport const byteSwapIfBE = isLE ? (n: number) => n : (n: number) => byteSwap(n);\n\n// In place byte swap for Uint32Array\nexport function byteSwap32(arr: Uint32Array) {\n  for (let i = 0; i < arr.length; i++) {\n    arr[i] = byteSwap(arr[i]);\n  }\n}\n\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) =>\n  i.toString(16).padStart(2, '0')\n);\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes: Uint8Array): string {\n  abytes(bytes);\n  // pre-caching improves the speed 6x\n  let hex = '';\n  for (let i = 0; i < bytes.length; i++) {\n    hex += hexes[bytes[i]];\n  }\n  return hex;\n}\n\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 } as const;\nfunction asciiToBase16(char: number): number | undefined {\n  if (char >= asciis._0 && char <= asciis._9) return char - asciis._0;\n  if (char >= asciis._A && char <= asciis._F) return char - (asciis._A - 10);\n  if (char >= asciis._a && char <= asciis._f) return char - (asciis._a - 10);\n  return;\n}\n\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex: string): Uint8Array {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  const hl = hex.length;\n  const al = hl / 2;\n  if (hl % 2) throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n  const array = new Uint8Array(al);\n  for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n    const n1 = asciiToBase16(hex.charCodeAt(hi));\n    const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n    if (n1 === undefined || n2 === undefined) {\n      const char = hex[hi] + hex[hi + 1];\n      throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n    }\n    array[ai] = n1 * 16 + n2;\n  }\n  return array;\n}\n\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => {};\n\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters: number, tick: number, cb: (i: number) => void) {\n  let ts = Date.now();\n  for (let i = 0; i < iters; i++) {\n    cb(i);\n    // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n    const diff = Date.now() - ts;\n    if (diff >= 0 && diff < tick) continue;\n    await nextTick();\n    ts += diff;\n  }\n}\n\n// Global symbols in both browsers and Node.js since v11\n// See https://github.com/microsoft/TypeScript/issues/31535\ndeclare const TextEncoder: any;\n\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str: string): Uint8Array {\n  if (typeof str !== 'string') throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n  return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n\nexport type Input = Uint8Array | string;\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data: Input): Uint8Array {\n  if (typeof data === 'string') data = utf8ToBytes(data);\n  abytes(data);\n  return data;\n}\n\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays: Uint8Array[]): Uint8Array {\n  let sum = 0;\n  for (let i = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    abytes(a);\n    sum += a.length;\n  }\n  const res = new Uint8Array(sum);\n  for (let i = 0, pad = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    res.set(a, pad);\n    pad += a.length;\n  }\n  return res;\n}\n\n// For runtime check if class implements interface\nexport abstract class Hash<T extends Hash<T>> {\n  abstract blockLen: number; // Bytes per block\n  abstract outputLen: number; // Bytes in output\n  abstract update(buf: Input): this;\n  // Writes digest into buf\n  abstract digestInto(buf: Uint8Array): void;\n  abstract digest(): Uint8Array;\n  /**\n   * Resets internal state. Makes Hash instance unusable.\n   * Reset is impossible for keyed hashes if key is consumed into state. If digest is not consumed\n   * by user, they will need to manually call `destroy()` when zeroing is necessary.\n   */\n  abstract destroy(): void;\n  /**\n   * Clones hash instance. Unsafe: doesn't check whether `to` is valid. Can be used as `clone()`\n   * when no options are passed.\n   * Reasons to use `_cloneInto` instead of clone: 1) performance 2) reuse instance => all internal\n   * buffers are overwritten => causes buffer overwrite which is used for digest in some cases.\n   * There are no guarantees for clean-up because it's impossible in JS.\n   */\n  abstract _cloneInto(to?: T): T;\n  // Safe version that clones internal state\n  clone(): T {\n    return this._cloneInto();\n  }\n}\n\n/**\n * XOF: streaming API to read digest in chunks.\n * Same as 'squeeze' in keccak/k12 and 'seek' in blake3, but more generic name.\n * When hash used in XOF mode it is up to user to call '.destroy' afterwards, since we cannot\n * destroy state, next call can require more bytes.\n */\nexport type HashXOF<T extends Hash<T>> = Hash<T> & {\n  xof(bytes: number): Uint8Array; // Read 'bytes' bytes from digest stream\n  xofInto(buf: Uint8Array): Uint8Array; // read buf.length bytes from digest stream into buf\n};\n\nconst toStr = {}.toString;\ntype EmptyObj = {};\nexport function checkOpts<T1 extends EmptyObj, T2 extends EmptyObj>(\n  defaults: T1,\n  opts?: T2\n): T1 & T2 {\n  if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n    throw new Error('Options should be object or undefined');\n  const merged = Object.assign(defaults, opts);\n  return merged as T1 & T2;\n}\n\nexport type CHash = ReturnType<typeof wrapConstructor>;\n\nexport function wrapConstructor<T extends Hash<T>>(hashCons: () => Hash<T>) {\n  const hashC = (msg: Input): Uint8Array => hashCons().update(toBytes(msg)).digest();\n  const tmp = hashCons();\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = () => hashCons();\n  return hashC;\n}\n\nexport function wrapConstructorWithOpts<H extends Hash<H>, T extends Object>(\n  hashCons: (opts?: T) => Hash<H>\n) {\n  const hashC = (msg: Input, opts?: T): Uint8Array => hashCons(opts).update(toBytes(msg)).digest();\n  const tmp = hashCons({} as T);\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (opts: T) => hashCons(opts);\n  return hashC;\n}\n\nexport function wrapXOFConstructorWithOpts<H extends HashXOF<H>, T extends Object>(\n  hashCons: (opts?: T) => HashXOF<H>\n) {\n  const hashC = (msg: Input, opts?: T): Uint8Array => hashCons(opts).update(toBytes(msg)).digest();\n  const tmp = hashCons({} as T);\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (opts: T) => hashCons(opts);\n  return hashC;\n}\n\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32): Uint8Array {\n  if (crypto && typeof crypto.getRandomValues === 'function') {\n    return crypto.getRandomValues(new Uint8Array(bytesLength));\n  }\n  // Legacy Node.js compatibility\n  if (crypto && typeof crypto.randomBytes === 'function') {\n    return crypto.randomBytes(bytesLength);\n  }\n  throw new Error('crypto.getRandomValues must be defined');\n}\n","import { exists, output } from './_assert.js';\nimport { Hash, createView, Input, toBytes } from './utils.js';\n\n/**\n * Polyfill for Safari 14\n */\nfunction setBigUint64(view: DataView, byteOffset: number, value: bigint, isLE: boolean): void {\n  if (typeof view.setBigUint64 === 'function') return view.setBigUint64(byteOffset, value, isLE);\n  const _32n = BigInt(32);\n  const _u32_max = BigInt(0xffffffff);\n  const wh = Number((value >> _32n) & _u32_max);\n  const wl = Number(value & _u32_max);\n  const h = isLE ? 4 : 0;\n  const l = isLE ? 0 : 4;\n  view.setUint32(byteOffset + h, wh, isLE);\n  view.setUint32(byteOffset + l, wl, isLE);\n}\n\n/**\n * Choice: a ? b : c\n */\nexport const Chi = (a: number, b: number, c: number) => (a & b) ^ (~a & c);\n\n/**\n * Majority function, true if any two inputs is true\n */\nexport const Maj = (a: number, b: number, c: number) => (a & b) ^ (a & c) ^ (b & c);\n\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nexport abstract class HashMD<T extends HashMD<T>> extends Hash<T> {\n  protected abstract process(buf: DataView, offset: number): void;\n  protected abstract get(): number[];\n  protected abstract set(...args: number[]): void;\n  abstract destroy(): void;\n  protected abstract roundClean(): void;\n  // For partial updates less than block size\n  protected buffer: Uint8Array;\n  protected view: DataView;\n  protected finished = false;\n  protected length = 0;\n  protected pos = 0;\n  protected destroyed = false;\n\n  constructor(\n    readonly blockLen: number,\n    public outputLen: number,\n    readonly padOffset: number,\n    readonly isLE: boolean\n  ) {\n    super();\n    this.buffer = new Uint8Array(blockLen);\n    this.view = createView(this.buffer);\n  }\n  update(data: Input): this {\n    exists(this);\n    const { view, buffer, blockLen } = this;\n    data = toBytes(data);\n    const len = data.length;\n    for (let pos = 0; pos < len; ) {\n      const take = Math.min(blockLen - this.pos, len - pos);\n      // Fast path: we have at least one block in input, cast it to view and process\n      if (take === blockLen) {\n        const dataView = createView(data);\n        for (; blockLen <= len - pos; pos += blockLen) this.process(dataView, pos);\n        continue;\n      }\n      buffer.set(data.subarray(pos, pos + take), this.pos);\n      this.pos += take;\n      pos += take;\n      if (this.pos === blockLen) {\n        this.process(view, 0);\n        this.pos = 0;\n      }\n    }\n    this.length += data.length;\n    this.roundClean();\n    return this;\n  }\n  digestInto(out: Uint8Array) {\n    exists(this);\n    output(out, this);\n    this.finished = true;\n    // Padding\n    // We can avoid allocation of buffer for padding completely if it\n    // was previously not allocated here. But it won't change performance.\n    const { buffer, view, blockLen, isLE } = this;\n    let { pos } = this;\n    // append the bit '1' to the message\n    buffer[pos++] = 0b10000000;\n    this.buffer.subarray(pos).fill(0);\n    // we have less than padOffset left in buffer, so we cannot put length in\n    // current block, need process it and pad again\n    if (this.padOffset > blockLen - pos) {\n      this.process(view, 0);\n      pos = 0;\n    }\n    // Pad until full block byte with zeros\n    for (let i = pos; i < blockLen; i++) buffer[i] = 0;\n    // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n    // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n    // So we just write lowest 64 bits of that value.\n    setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n    this.process(view, 0);\n    const oview = createView(out);\n    const len = this.outputLen;\n    // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n    if (len % 4) throw new Error('_sha2: outputLen should be aligned to 32bit');\n    const outLen = len / 4;\n    const state = this.get();\n    if (outLen > state.length) throw new Error('_sha2: outputLen bigger than state');\n    for (let i = 0; i < outLen; i++) oview.setUint32(4 * i, state[i], isLE);\n  }\n  digest() {\n    const { buffer, outputLen } = this;\n    this.digestInto(buffer);\n    const res = buffer.slice(0, outputLen);\n    this.destroy();\n    return res;\n  }\n  _cloneInto(to?: T): T {\n    to ||= new (this.constructor as any)() as T;\n    to.set(...this.get());\n    const { blockLen, buffer, length, finished, destroyed, pos } = this;\n    to.length = length;\n    to.pos = pos;\n    to.finished = finished;\n    to.destroyed = destroyed;\n    if (length % blockLen) to.buffer.set(buffer);\n    return to;\n  }\n}\n","import { HashMD, Chi, Maj } from './_md.js';\nimport { rotr, wrapConstructor } from './utils.js';\n\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n  0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n  0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n  0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n  0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n  0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n  0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n  0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n  0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n\n// Initial state:\n// first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19\n// prettier-ignore\nconst SHA256_IV = /* @__PURE__ */ new Uint32Array([\n  0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nexport class SHA256 extends HashMD<SHA256> {\n  // We cannot use array here since array allows indexing by variable\n  // which means optimizer/compiler cannot use registers.\n  A = SHA256_IV[0] | 0;\n  B = SHA256_IV[1] | 0;\n  C = SHA256_IV[2] | 0;\n  D = SHA256_IV[3] | 0;\n  E = SHA256_IV[4] | 0;\n  F = SHA256_IV[5] | 0;\n  G = SHA256_IV[6] | 0;\n  H = SHA256_IV[7] | 0;\n\n  constructor() {\n    super(64, 32, 8, false);\n  }\n  protected get(): [number, number, number, number, number, number, number, number] {\n    const { A, B, C, D, E, F, G, H } = this;\n    return [A, B, C, D, E, F, G, H];\n  }\n  // prettier-ignore\n  protected set(\n    A: number, B: number, C: number, D: number, E: number, F: number, G: number, H: number\n  ) {\n    this.A = A | 0;\n    this.B = B | 0;\n    this.C = C | 0;\n    this.D = D | 0;\n    this.E = E | 0;\n    this.F = F | 0;\n    this.G = G | 0;\n    this.H = H | 0;\n  }\n  protected process(view: DataView, offset: number): void {\n    // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n    for (let i = 0; i < 16; i++, offset += 4) SHA256_W[i] = view.getUint32(offset, false);\n    for (let i = 16; i < 64; i++) {\n      const W15 = SHA256_W[i - 15];\n      const W2 = SHA256_W[i - 2];\n      const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n      const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n      SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n    }\n    // Compression function main loop, 64 rounds\n    let { A, B, C, D, E, F, G, H } = this;\n    for (let i = 0; i < 64; i++) {\n      const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n      const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n      const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n      const T2 = (sigma0 + Maj(A, B, C)) | 0;\n      H = G;\n      G = F;\n      F = E;\n      E = (D + T1) | 0;\n      D = C;\n      C = B;\n      B = A;\n      A = (T1 + T2) | 0;\n    }\n    // Add the compressed chunk to the current hash value\n    A = (A + this.A) | 0;\n    B = (B + this.B) | 0;\n    C = (C + this.C) | 0;\n    D = (D + this.D) | 0;\n    E = (E + this.E) | 0;\n    F = (F + this.F) | 0;\n    G = (G + this.G) | 0;\n    H = (H + this.H) | 0;\n    this.set(A, B, C, D, E, F, G, H);\n  }\n  protected roundClean() {\n    SHA256_W.fill(0);\n  }\n  destroy() {\n    this.set(0, 0, 0, 0, 0, 0, 0, 0);\n    this.buffer.fill(0);\n  }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n  A = 0xc1059ed8 | 0;\n  B = 0x367cd507 | 0;\n  C = 0x3070dd17 | 0;\n  D = 0xf70e5939 | 0;\n  E = 0xffc00b31 | 0;\n  F = 0x68581511 | 0;\n  G = 0x64f98fa7 | 0;\n  H = 0xbefa4fa4 | 0;\n  constructor() {\n    super();\n    this.outputLen = 28;\n  }\n}\n\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\n/**\n * SHA2-224 hash function\n */\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n"],"mappings":"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","names":["Databeat","bytes","isLE","Ident","Databeat","sid"]}